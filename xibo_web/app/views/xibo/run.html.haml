- content_for :title, "Command Result"
- content_for :page_header, "Command Result: #{@command}"

- if Rails.env.development?
  %details
    %summary Debug Info
    %pre
      @result: #{@result.inspect}
      @command: #{@command.inspect}
      stdout length: #{@result&.[](:stdout)&.length}
      stderr length: #{@result&.[](:stderr)&.length}

- if @result.nil?
  %article
    %h2 Error
    %p
      %strong Failed to execute command
    %output
      %pre No result returned from command execution
- else
  %article
    %h2 Command: #{@command}

    %p
      %strong
        Status: #{@result[:success] ? '✓ Success' : '✗ Failed'}
        (Exit code: #{@result[:exit_code]})

    - if @result[:stdout].present?
      %h3 Output:
      %output
        %pre= ansi_to_html(@result[:stdout]).html_safe

    - if @result[:stderr].present?
      %h3 Error Output:
      %output
        %pre= ansi_to_html(@result[:stderr]).html_safe
    
    - if !@result[:stdout].present? && !@result[:stderr].present?
      %p
        %em No output generated

%nav
  = link_to '← Back to Commands', xibo_index_path + (params[:tab].present? ? "##{params[:tab]}" : '')
